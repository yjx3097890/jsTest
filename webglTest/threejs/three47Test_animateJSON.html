<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>update things</title>
    <style>
        body { margin: 0; }
        canvas { width: 100%; height: 100% }
    </style>
</head>
<body>
<div id="container"></div>
<script src="85/three.js"></script>
<script src="85/Detector.js"></script>
<script>

    let scene;
    let camera;
    let renderer;
    let cube;
    let mixer;
    let clock;

    const init =  function (callback) {
         scene = new THREE.Scene();
         camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
        camera.position.z = 5;
        camera.position.y = 3;
        camera.lookAt(new THREE.Vector3());

        let light = new THREE.PointLight( 0xffffff, 1, 100 );
        light.position.set( -10, 10, 10 );
        scene.add( light );
        let ambientLight = new THREE.AmbientLight( 0xcccccc );
        scene.add( ambientLight );


        renderer = new THREE.WebGLRenderer();
        renderer.setSize( window.innerWidth, window.innerHeight );
        document.body.appendChild( renderer.domElement );


        const loader = new THREE.JSONLoader();

        loader.load( './boneAni.json', function ( geometry, materials ) {

            materials.forEach(function (material) {
                material.skinning = true;
               // material.color.setHex( 0xffaaaa );
            });
            cube = new THREE.SkinnedMesh( geometry, materials );

            let s = THREE.Math.randFloat( 0.00075, 0.001 );
          //  cube.scale.set( s, s, s );

            scene.add(cube);


            let clips = geometry.animations;
            mixer = new THREE.AnimationMixer( cube );



//            clips.forEach( function ( clip ) {
//                mixer.clipAction( clip ).play();
//            } );

            let clip = THREE.AnimationClip.findByName( clips, 'ArmatureAction' );
            let action = mixer.clipAction( clip );
            action.play();


            callback && callback(0);

        });


        clock = new THREE.Clock();


    };




    const animate = function (timestamp) {


        if (mixer) {

            mixer.update( clock.getDelta() );
        }

        renderer.render( scene, camera );
        requestAnimationFrame( animate );
    };


    if (Detector.webgl) {
        init(animate);

    } else {
        let warning = Detector.getWebGLErrorMessage();
        document.getElementById('container').appendChild(warning);
    }

</script>
</body>
</html>