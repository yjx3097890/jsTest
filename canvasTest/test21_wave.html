<!DOCTYPE html>
<html>
		<head>
            <title>wave
            </title>
        </head>
    <body>
    	<canvas id="canvas" width="800" height="500" style="border:solid 1px #aaaaaa; background-color:#000"></canvas>
    	<script type="text/javascript" src="Vector2.js"></script>
    	<script type="text/javascript" src="wind-all-0.7.3.js"></script>
    	<script type="text/javascript">
    		var Ball = function (position, radius, color) {
    			this.position = position.clone() || new Vector2() ;
    			this.radius = radius || 5;
    			this.color = color || "#ffffff";
    		};
    		Ball.prototype.draw = function (context) {
    			context.save();
 				context.fillStyle = this.color;
 				context.beginPath();
 				context.arc(this.position.x, this.position.y, this.radius, 0, Math.PI*2);
 				context.closePath();
    			context.fill();
    			context.restore();
    		};
    	</script>
        <script type="text/javascript">
            var canvas = document.getElementById("canvas"),
                context = canvas.getContext("2d"),
                 alpha = 0, //相位
                 PI = Math.PI, number=20,
                r = 5,
         		theta = 2*PI / number,  //每个球的相位差
                 dif = 25, //帧数
         		delta = 2*PI / dif / 20,//每次变化相位
         		A = 20, //振幅
            	i,
            	balls = [], ball;

         	for (i = number -1; i >= 0 ; i--) {
         		ball = new Ball(new Vector2( (2*i+2)*r, canvas.height/2 + A*Math.sin(i*theta)), r, randomColor());
         		balls.push(ball);
         	}
		   	var wave = eval(Wind.compile("async", function () {
         		while (true) {
         			context.clearRect(0,0,canvas.width, canvas.height);
         			for (var i = balls.length - 1; i >= 0; i--) {
         					alpha += delta;
         					balls[i].position.y = canvas.height/2 + A*Math.sin(i*theta + alpha);
         					balls[i].color = randomColor();
         					balls[i].draw(context);
         				};
         			$await(Wind.Async.sleep(1000/dif));
         		}
         	}));	
           
            wave().start();
  
  		function randomColor() {
           var arrHex = ["0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "A", "B", "C", "D", "E", "F"]; var strHex = "#";
           var index;
           for (var i = 0; i < 6; i++) {
               index = Math.round(Math.random() * 15);
               strHex += arrHex[index];
           }
           return strHex;
       } 

        </script>
    </body>
</html>