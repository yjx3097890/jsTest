<!DOCTYPE html>
<html>
	<head>
		<title>Free-Falling</title>
        <meta charset="utf-8"/>
	</head>
    <body>
    	<canvas id="canvas" width="1300" height="600" style="border:1px solid #d3d3d3;"></canvas>
        <script type="text/javascript" src = "wind-all-0.7.3.js"></script>
        <script type="text/javascript">
            var  f = 60, r = 10, g = 9.8
            canvas = document.getElementById("canvas"),
            context = canvas.getContext("2d");
            var ball = {
                position: {x:  canvas.width / 2, y: canvas.height / 2},
                radius: r,
                velocity: {x: 0, y: 0},
                acceleration: {x: 0, y : 9.8}
            };
            
            var draw = eval(Wind.compile("async", function() {
            
                while(true){
                    context.fillStyle = "rgba(0, 0, 0, 0.1)";  //实现残影效果
                    context.fillRect(0, 0, canvas.width, canvas.height);
                   
                    context.beginPath();
                   context.fillStyle = "#DA3571";
                   context.arc(ball.position.x, ball.position.y, ball.radius, 0, Math.PI * 2);
                   context.closePath();
                   context.fill();
                   
                      //先算距离
                    ball.position.x += ball.velocity.x * 10 / f;
                    ball.position.y += ball.velocity.y * 10 / f;
                   
                   if( ball.position.y + ball.radius >= canvas.height ) {
                        if(ball.velocity.y > 0) {
                        //    ball.velocity.y *= -(1 ); 
                            ball.velocity.y *= -(1 - 0.3); 
                        }
                   }else{
                        ball.velocity.x += ball.acceleration.x * 10 / f;
                        ball.velocity.y += ball.acceleration.y * 10 / f;
                   }
                   
             
                   $await(Wind.Async.sleep(1000 / f));
                   
               
                }
                
            })); 
            
            draw().start();
        </script>
    </body>
</html>