<!DOCTYPE html>
<html>
  <head>
    <title></title>
    <style media="screen">
#CHH { fill: #ddc; }
  #CHI { fill: #cdd; }
  #PFA { fill: #cdc; }
  .subunit-label {
    fill: #777;
    fill-opacity: .5;
    font-size: 20px;
    font-weight: 300;
    text-anchor: middle;
  }
    </style>
  </head>
  <body>

<script src="d3.js" charset="utf-8"></script>
<script src="topojson.v1.min.js" charset="utf-8"></script>
<script type="text/javascript">
  var width = 960;
  var height = 500;

  var svg= d3.select('body')
  .append('svg')
  .attr('width', width)
  .attr('height', height);

  var projection= d3.geo.mercator().center([110,37]).scale(550).translate([width/2,height/2]);
  var projection1 = d3.geo.albers()
    .center([0, 255.4])
    .rotate([4.4, 0])
    .parallels([50, 60])
    .scale(6000)
    .translate([width / 2, height / 2]);

    var path = d3.geo.path()
    .projection(projection);

    d3.json('china.json', function (e, china) {
      if (e) return console.log(e);

      svg.selectAll('.sub')
      .data(topojson.feature(china, china.objects.subunits).features)//在转换为GeoJSON格式
      .enter()
      .append('path')
      .attr('id', function (d) {
        console.log(d.id);
         return d.id;
      })
      .attr('d', d3.geo.path().projection(projection));


      svg.append("path")
    .datum(topojson.feature(china, china.objects.places))
    .attr("d", path)
    .attr("class", "place");

  //   svg.selectAll(".place-label")
  //   .data(topojson.feature(china, china.objects.places).features)
  // .enter().append("text")
  //   .attr("class", "place-label")
  //   .attr("transform", function(d) { return "translate(" + projection(d.geometry.coordinates) + ")"; })
  //   .attr("dy", ".35em")
  //   .text(function(d) { return d.properties.name; });





  svg.selectAll(".subunit-label")
  .data(topojson.feature(china, china.objects.subunits).features)
.enter().append("text")
  .attr("class", function(d) { return "subunit-label " + d.id; })
  .attr("transform", function(d) { return "translate(" + path.centroid(d) + ")"; })  //计算图心
  .attr("dy", ".35em")
  .text(function(d) { return d.properties.name; });

    });




</script>
  </body>
</html>
